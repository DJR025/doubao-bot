<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>豆包大模型招生助手</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:system-ui,Helvetica;background:linear-gradient(135deg,#0f2027,#203a43);
    display:flex;justify-content:center;align-items:center;min-height:100vh;color:#fff;}
.box{width:90%;max-width:700px;background:rgba(255,255,255,0.1);
    backdrop-filter:blur(10px);border-radius:16px;border:1px solid rgba(255,255,255,0.2);
    box-shadow:0 20px 40px rgba(0,0,0,0.2);display:flex;flex-direction:column;height:80vh;}
.head{background:rgba(0,0,0,0.2);padding:18px;text-align:center;font-size:1.3em;
    font-weight:bold;border-bottom:1px solid gba(255,255,255,0.1);}
#chat{flex:1;overflow-y:auto;padding:15px;}
.msg{margin:8px0;padding:10px 14px;border-radius:18px;max-width:75%;word-break:break-all;
    animation:fade 0.3s;}
.user{background:rgba(255,255,255,0.2);margin-left:auto;border-bottom-right-radius:4px;}
.ai{background:rgba(0,123,255,0.2);margin-right:auto;border-bottom-left-radius:4px;}
@keyframes fade{from{opacity:0;transform:translateY(10px);}}
#form{display:flex;padding:12px;border-top:1px solid rgba(255,255,255,0.1);}
#inp{flex:1;padding:12px 16px;background:rgba(0,0,0,0.2);
    border:1px solid rgba(255,255,255,0.1);border-radius:24px;color:#fff;outline:none;}
#inp::placeholder{color:rgba(255,255,255,0.6);}
#btn{width:80px;margin-left:8px;border:none;border-radius:24px;background:rgba(0,123,255,0.7);
    color:#fff;font-weight:bold;cursor:pointer;transition:background0.2s;}
#btn:hover{background:rgba(0,123,255,0.9);}
.typing{display:none;margin-right:auto;background:rgba(0,123,255,0.2);padding:10px 14px;
    border-radius:18px;border-bottom-left-radius:4px;}
.typing span{display:inline-block;width:8px;height:8px;border-radius:50%;
    background:#fff;margin:0 2px;animation:dot 1.4s infinite;}
.typing span:nth-child(2){animation-delay:0.2s;}
.typing span:nth-child(3){animation-delay:0.4s;}
@keyframes dot{0%,80%,100%{opacity:0.3;}40%{opacity:1;}}
</style>
</head>
<body>
<div class="box">
<div class="head">🤖 豆包大模型 · 招生助手</div>>
<div id="chat">
<div class="msg ai">你好！我是豆包大模型，请问想了解什么招生信息？</div>
<div class="typing" id="typing"><span></span><span></span><span></span></div>
</div>
<form id="form">
<input id="inp" maxlength="200" placeholder="输入问题，回车发送">
<button id="btn">发送</button>
</form>
</div>

<script>
const chat = document.getElementById('chat');
const form = document.getElementById('form');
const input = document.getElementById('inp');
const typing = document.getElementById('typing');

form.addEventListener('submit', async(e)=>{
e.preventDefault();
const text = input.value.trim();
if(!text) return;
append(text,'user');
input.value='';
showTyping(true);
const reply = await callDoubao(text);
showTyping(false);
append(reply,'ai');
});

function append(txt,who){
const div = document.createElement('div');
div.className = 'msg ' + who;
div.textContent = txt;
chat.insertBefore(div,typing);
chat.scrollTop = chat.scrollHeight;
}
function showTyping(on){ typing.style.display = on ? 'block' : 'none'; }

/* 核心：调用后端云函数*/
async function callDoubao(user){
const res = await fetch('/netlify/fuctions/doubao',{
method: 'POST',
headers:{'Content-Type':'application/json'},
body: JSON.stringify({user})
});
const data = await res.json();
return data.reply;
}
</script>
</body>
</html>